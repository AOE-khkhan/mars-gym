

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Start &mdash; MARS 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Evaluation Plaftform" href="dataviz.html" />
    <link rel="prev" title="Install" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MARS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to MARS’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dataset">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prepare-data">Prepare data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-and-simulation">Model and Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#supervised-learning">Supervised Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#evaluation">Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dataviz.html">Evaluation Plaftform</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guilde_data_enginnering_module.html">Data Enginnering Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="guilde_simulation_module.html">Simulation Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="guilde_evaluation_module.html">Evaluation Module</a></li>
</ul>
<p class="caption"><span class="caption-text">MARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MARS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Quick Start</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/quick_start.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="section" id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mars_gym.data</span> <span class="kn">import</span> <span class="n">utils</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">utils</span><span class="o">.</span><span class="n">datasets</span><span class="p">()</span>
 <span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">,</span>
<span class="s1">&#39;yoochoose&#39;</span><span class="p">,</span>
<span class="s1">&#39;processed_yoochoose&#39;</span><span class="p">,</span>
<span class="s1">&#39;trivago_rio&#39;</span><span class="p">,</span>
<span class="s1">&#39;processed_trivago_rio&#39;</span><span class="p">]</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">,</span> <span class="n">df_meta</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;processed_trivago_rio&#39;</span><span class="p">)</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
   <span class="n">session_id</span>    <span class="n">user_id</span>       <span class="n">timestamp</span>   <span class="n">action_type</span>       <span class="n">item_id</span>   <span class="n">impressions</span>                                       <span class="n">list_reference_item</span>                             <span class="n">pos_item_id</span> <span class="n">clicked</span>
 <span class="mi">0</span> <span class="mi">05</span><span class="n">fe82b496fb9</span> <span class="n">M1Z13DD0P2KH</span>  <span class="mi">1541422443</span>  <span class="n">clickout</span> <span class="n">item</span>     <span class="mi">4304686</span>   <span class="p">[</span><span class="s1">&#39;109351&#39;</span><span class="p">,</span> <span class="s1">&#39;150138&#39;</span><span class="p">,</span> <span class="s1">&#39;4345728&#39;</span><span class="p">,</span> <span class="s1">&#39;105014&#39;</span><span class="p">,</span> <span class="s1">&#39;478&#39;</span><span class="o">...</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>                            <span class="mi">7</span>           <span class="mf">1.0</span>
 <span class="mi">1</span> <span class="mi">05</span><span class="n">fe82b496fb9</span> <span class="n">M1Z13DD0P2KH</span>  <span class="mi">1541422474</span>  <span class="n">clickout</span> <span class="n">item</span>     <span class="mi">960255</span>    <span class="p">[</span><span class="s1">&#39;1475717&#39;</span><span class="p">,</span> <span class="s1">&#39;5196406&#39;</span><span class="p">,</span> <span class="s1">&#39;104880&#39;</span><span class="p">,</span> <span class="s1">&#39;109351&#39;</span><span class="p">,</span> <span class="s1">&#39;68&#39;</span><span class="o">...</span> <span class="p">[</span><span class="s1">&#39;4304686&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>                     <span class="mi">20</span>          <span class="mf">1.0</span>
 <span class="mi">2</span> <span class="mi">05</span><span class="n">fe82b496fb9</span> <span class="n">M1Z13DD0P2KH</span>  <span class="mi">1541423039</span>  <span class="n">clickout</span> <span class="n">item</span>     <span class="mi">2188598</span>   <span class="p">[</span><span class="s1">&#39;104558&#39;</span><span class="p">,</span> <span class="s1">&#39;326781&#39;</span><span class="p">,</span> <span class="s1">&#39;104786&#39;</span><span class="p">,</span> <span class="s1">&#39;1223390&#39;</span><span class="p">,</span> <span class="s1">&#39;206&#39;</span><span class="o">...</span> <span class="p">[</span><span class="s1">&#39;4304686&#39;</span><span class="p">,</span> <span class="s1">&#39;960255&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>               <span class="mi">9</span>           <span class="mf">1.0</span>
 <span class="mi">3</span> <span class="mi">05</span><span class="n">fe82b496fb9</span> <span class="n">M1Z13DD0P2KH</span>  <span class="mi">1541424631</span>  <span class="n">clickout</span> <span class="n">item</span>     <span class="mi">8459162</span>   <span class="p">[</span><span class="s1">&#39;105014&#39;</span><span class="p">,</span> <span class="s1">&#39;5659850&#39;</span><span class="p">,</span> <span class="s1">&#39;478121&#39;</span><span class="p">,</span> <span class="s1">&#39;109351&#39;</span><span class="p">,</span> <span class="s1">&#39;956&#39;</span><span class="o">...</span> <span class="p">[</span><span class="s1">&#39;4304686&#39;</span><span class="p">,</span> <span class="s1">&#39;960255&#39;</span><span class="p">,</span> <span class="s1">&#39;2188598&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>        <span class="mi">23</span>          <span class="mf">1.0</span>
 <span class="mi">4</span> <span class="mi">05</span><span class="n">fe82b496fb9</span> <span class="n">M1Z13DD0P2KH</span>  <span class="mi">1541424685</span>  <span class="n">interaction</span> <span class="n">info</span>  <span class="mi">8459162</span>   <span class="n">NaN</span>                                                <span class="p">[</span><span class="s1">&#39;4304686&#39;</span><span class="p">,</span> <span class="s1">&#39;960255&#39;</span><span class="p">,</span> <span class="s1">&#39;2188598&#39;</span><span class="p">,</span> <span class="s1">&#39;8459162&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">-</span><span class="mi">1</span>          <span class="mf">0.0</span>

 <span class="o">&gt;&gt;&gt;</span> <span class="n">df_meta</span><span class="p">[[</span><span class="s1">&#39;list_metadata&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
   <span class="n">list_metadata</span>
 <span class="mi">0</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span>
 <span class="mi">1</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span>
 <span class="mi">2</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span>
 <span class="mi">3</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span>
 <span class="mi">4</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
</div>
<div class="section" id="prepare-data">
<h2>Prepare data<a class="headerlink" href="#prepare-data" title="Permalink to this headline">¶</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PrepareInteractionData</span><span class="p">(</span><span class="n">luigi</span><span class="o">.</span><span class="n">Task</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">requires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DownloadDataset</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;processed_trivago_rio&quot;</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">luigi</span><span class="o">.</span><span class="n">LocalTarget</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATASET_DIR</span><span class="p">,</span> <span class="s2">&quot;dataset.csv&quot;</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATASET_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># .... transform dataset</span>

        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">()</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PrepareMetaData</span><span class="p">(</span><span class="n">luigi</span><span class="o">.</span><span class="n">Task</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">requires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DownloadDataset</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;processed_trivago_rio&quot;</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="n">OUTPUT_PATH</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">luigi</span><span class="o">.</span><span class="n">LocalTarget</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATASET_DIR</span><span class="p">,</span> <span class="s2">&quot;metadata.csv&quot;</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATASET_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># .... transform dataset</span>

        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">()</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;item_id&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PrepareTrivagoDataFrame</span><span class="p">(</span><span class="n">BasePrepareDataFrames</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">requires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">PrepareInteractionData</span><span class="p">(),</span>
            <span class="n">PrepareMetaData</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timestamp_property</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;timestamp&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dataset_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DATASET_DIR</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">read_data_frame_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata_data_frame_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">job</span> <span class="o">=</span> <span class="n">PrepareTrivagoDataFrame</span><span class="p">()</span>
<span class="go">PrepareTrivagoDataFrame(session_test_size=0.1, test_size=0.2, sample_size=-1,</span>
<span class="go">minimum_interactions=5, dataset_split_method=time, column_stratification=None,</span>
<span class="go">test_split_type=random, n_splits=10, split_index=0, val_size=0.2,</span>
<span class="go">sampling_strategy=none, balance_fields=[], sampling_proportions={},</span>
<span class="go">use_sampling_in_validation=False, eq_filters={}, neq_filters={},</span>
<span class="go">isin_filters={}, seed=42)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">luigi</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="n">job</span><span class="p">],</span> <span class="n">local_scheduler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">....</span>
<span class="go">INFO: Worker Worker(salt=154256821, workers=1, host=marlesson-pc, username=marlesson,</span>
<span class="go">pid=16527) was stopped. Shutting down Keep-Alive thread</span>
<span class="go">INFO:</span>
<span class="go">===== Luigi Execution Summary =====</span>

<span class="go">Scheduled 4 tasks of which:</span>
<span class="go">* 4 ran successfully:</span>
<span class="go">    - 1 DownloadDataset(output_path=output, dataset=processed_trivago_rio)</span>
<span class="go">    - 1 PrepareInteractionData()</span>
<span class="go">    - 1 PrepareMetaData()</span>
<span class="go">    - 1 PrepareTrivagoDataFrame(...)</span>

<span class="go">This progress looks :) because there were no failed tasks or missing dependencies</span>

<span class="go">===== Luigi Execution Summary =====</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">job</span><span class="o">.</span><span class="n">output</span><span class="p">()]</span>
<span class="go">[&#39;.../train_cc25c002c7.csv&#39;,</span>
<span class="go">&#39;.../val_cc25c002c7.csv&#39;,</span>
<span class="go">&#39;.../test_cc25c002c7.csv&#39;,</span>
<span class="go">&#39;.../metadata.csv&#39;]</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<ul class="simple">
<li><p>DATASET_DIR/train_cc25c002c7.csv</p></li>
<li><p>DATASET_DIR/val_cc25c002c7.csv</p></li>
<li><p>DATASET_DIR/test_cc25c002c7.csv</p></li>
<li><p>DATASET_DIR/metadata.csv</p></li>
</ul>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mars_gym.data.dataset</span> <span class="kn">import</span> <span class="n">InteractionsDataset</span>
<span class="kn">from</span> <span class="nn">mars_gym.meta_config</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">samples.trivago_rio</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">trivago_rio</span> <span class="o">=</span> <span class="n">ProjectConfig</span><span class="p">(</span>
    <span class="n">base_dir</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">BASE_DIR</span><span class="p">,</span>
    <span class="n">prepare_data_frames_task</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">PrepareTrivagoDataFrame</span><span class="p">,</span>
    <span class="n">dataset_class</span><span class="o">=</span><span class="n">InteractionsDataset</span><span class="p">,</span>
    <span class="n">user_column</span><span class="o">=</span><span class="n">Column</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="n">IOType</span><span class="o">.</span><span class="n">INDEXABLE</span><span class="p">),</span>
    <span class="n">item_column</span><span class="o">=</span><span class="n">Column</span><span class="p">(</span><span class="s2">&quot;item_id&quot;</span><span class="p">,</span> <span class="n">IOType</span><span class="o">.</span><span class="n">INDEXABLE</span><span class="p">),</span>
    <span class="n">available_arms_column_name</span><span class="o">=</span><span class="s2">&quot;impressions&quot;</span><span class="p">,</span>
    <span class="n">other_input_columns</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;pos_item_id&quot;</span><span class="p">,</span> <span class="n">IOType</span><span class="o">.</span><span class="n">NUMBER</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;list_reference_item&quot;</span><span class="p">,</span> <span class="n">IOType</span><span class="o">.</span><span class="n">INDEXABLE_ARRAY</span><span class="p">,</span> <span class="n">same_index_as</span><span class="o">=</span><span class="s2">&quot;item_id&quot;</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">metadata_columns</span><span class="o">=</span><span class="p">[</span><span class="n">Column</span><span class="p">(</span><span class="s2">&quot;list_metadata&quot;</span><span class="p">,</span> <span class="n">IOType</span><span class="o">.</span><span class="n">INT_ARRAY</span><span class="p">),],</span>
    <span class="n">output_column</span><span class="o">=</span><span class="n">Column</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="n">IOType</span><span class="o">.</span><span class="n">NUMBER</span><span class="p">),</span>
    <span class="n">recommender_type</span><span class="o">=</span><span class="n">RecommenderType</span><span class="o">.</span><span class="n">USER_BASED_COLLABORATIVE_FILTERING</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</div>
</div>
<div class="section" id="model-and-simulation">
<h2>Model and Simulation<a class="headerlink" href="#model-and-simulation" title="Permalink to this headline">¶</a></h2>
<p><strong>Model</strong></p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">luigi</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">mars_gym.meta_config</span> <span class="kn">import</span> <span class="n">ProjectConfig</span>
<span class="kn">from</span> <span class="nn">mars_gym.model.abstract</span> <span class="kn">import</span> <span class="n">RecommenderModule</span>


<span class="k">class</span> <span class="nc">SimpleLinearModel</span><span class="p">(</span><span class="n">RecommenderModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project_config</span><span class="p">:</span> <span class="n">ProjectConfig</span><span class="p">,</span>
        <span class="n">index_mapping</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
    <span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      build model architecture</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project_config</span><span class="p">,</span> <span class="n">index_mapping</span><span class="p">)</span>
      <span class="c1">#...</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">user_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">item_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">pos_item_id</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">list_reference_item</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">list_metadata</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      build forward</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">pass</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleLinearModel</span><span class="p">(</span><span class="n">RecommenderModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project_config</span><span class="p">:</span> <span class="n">ProjectConfig</span><span class="p">,</span>
        <span class="n">index_mapping</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
        <span class="n">n_factors</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">metadata_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">window_hist_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project_config</span><span class="p">,</span> <span class="n">index_mapping</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">user_embeddings</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_users</span><span class="p">,</span> <span class="n">n_factors</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_embeddings</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_items</span><span class="p">,</span> <span class="n">n_factors</span><span class="p">)</span>

        <span class="c1"># user + item + flatten hist + position + metadata</span>
        <span class="n">num_dense</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n_factors</span> <span class="o">+</span> <span class="n">window_hist_size</span> <span class="o">*</span> <span class="n">n_factors</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">metadata_size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_dense</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">SELU</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">input</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">user_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">item_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">pos_item_id</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">list_reference_item</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">list_metadata</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">user_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_embeddings</span><span class="p">(</span><span class="n">user_ids</span><span class="p">)</span>
        <span class="n">item_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_embeddings</span><span class="p">(</span><span class="n">item_ids</span><span class="p">)</span>
        <span class="n">history_items_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_embeddings</span><span class="p">(</span><span class="n">list_reference_item</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">user_emb</span><span class="p">,</span>
                <span class="n">item_emb</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">history_items_emb</span><span class="p">),</span>
                <span class="n">pos_item_id</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">list_metadata</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span>
            <span class="p">),</span>
            <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Bandit</strong></p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mars_gym.model.bandit</span> <span class="kn">import</span> <span class="n">BanditPolicy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="k">class</span> <span class="nc">BasePolicy</span><span class="p">(</span><span class="n">BanditPolicy</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reward_model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize bandit information and params</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reward_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_select_idx</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">arm_indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">arm_contexts</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">arm_scores</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Choice the index of arm selected in turn</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">action</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EGreedyPolicy</span><span class="p">(</span><span class="n">BanditPolicy</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reward_model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reward_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_select_idx</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">arm_indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">arm_contexts</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">arm_scores</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>

        <span class="n">n_arms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arm_indices</span><span class="p">)</span>
        <span class="n">arm_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_arms</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_arms</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">]):</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arm_indices</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">arm_probas</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">arm_scores</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">action</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<p><strong>Simulation</strong></p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">job_train</span> <span class="o">=</span> <span class="n">InteractionTraining</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">project</span><span class="o">=</span><span class="s2">&quot;samples.trivago_simple.config.trivago_rio&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">recommender_module_class</span><span class="o">=</span><span class="s2">&quot;samples.trivago_simple.simulation.SimpleLinearModel&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">recommender_extra_params</span><span class="o">=</span><span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="s2">&quot;n_factors&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="s2">&quot;metadata_size&quot;</span><span class="p">:</span> <span class="mi">148</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="s2">&quot;window_hist_size&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bandit_policy_class</span><span class="o">=</span><span class="s2">&quot;samples.trivago_simple.simulation.EGreedyPolicy&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bandit_policy_params</span><span class="o">=</span><span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">obs_batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">num_episodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>

<span class="go">InteractionTraining(project=samples.trivago_simple.config.trivago_rio,</span>
<span class="go">minimum_interactions=5, session_test_size=0.1, dataset_split_method=time,</span>
<span class="go">val_size=0.2, n_splits=5, split_index=0, data_frames_preparation_extra_params={},</span>
<span class="go">sampling_strategy=none, balance_fields=[], sampling_proportions={},</span>
<span class="go">use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={},</span>
<span class="go">seed=42, observation=, negative_proportion=0.0,</span>
<span class="go">recommender_module_class=samples.trivago_simple.simulation.SimpleLinearModel,</span>
<span class="go">recommender_extra_params={&quot;n_factors&quot;: 10, &quot;metadata_size&quot;: 148, &quot;window_hist_size&quot;: 5},</span>
<span class="go">device=cuda, batch_size=500, epochs=100, optimizer=adam, optimizer_params={},</span>
<span class="go">learning_rate=0.001, loss_function_params={}, gradient_norm_clipping=0.0,</span>
<span class="go">gradient_norm_clipping_type=2, early_stopping_patience=5, early_stopping_min_delta=0.001,</span>
<span class="go">monitor_metric=val_loss, monitor_mode=min, generator_workers=0, pin_memory=False,</span>
<span class="go">policy_estimator_extra_params={}, metrics=[&quot;loss&quot;],</span>
<span class="go">bandit_policy_class=samples.trivago_simple.simulation.EGreedyPolicy,</span>
<span class="go">bandit_policy_params={&quot;epsilon&quot;: 0.1, &quot;seed&quot;: 42}, loss_function=crm, test_size=0.1,</span>
<span class="go">test_split_type=time, val_split_type=time, crm_ps_strategy=bandit,</span>
<span class="go">obs_batch_size=100, num_episodes=1, sample_size=-1, full_refit=False, output_model_dir=)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">luigi</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="n">job_train</span><span class="p">],</span> <span class="n">local_scheduler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="go">0/100(t): 100%|████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00&lt;00:00, 30.32it/s, loss=0.0025, running_loss=0.0024]</span>
<span class="go">1/100(t): 100%|█████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00&lt;00:00, 45.82it/s, loss=0.003, running_loss=0.0028]</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="go">10/100(v): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00&lt;00:00, 81.10it/s, val_loss=0.2949]</span>

<span class="go">Interaction Stats (75.36%)</span>
<span class="go">          count      mean       std</span>
<span class="go">dataset</span>
<span class="go">all      7300.0  0.044110  0.205353</span>
<span class="go">train    5840.0  0.042808  0.202442</span>
<span class="go">valid    1460.0  0.049315  0.216599</span>

<span class="go">Saving logs...</span>
<span class="go">Saving test set predictions...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 4063441.72it/s]</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 3831989.55it/s]</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:16&lt;00:00, 151.33it/s]</span>

<span class="go">INFO: Informed scheduler that task   InteractionTraining____samples_trivago____epsilon___0_1__4fc1370d9d   has status   DONE</span>
<span class="go">2020-06-22 08:41:37,842 : INFO : Informed scheduler that task   InteractionTraining____samples_trivago____epsilon___0_1__4fc1370d9d   has status   DONE</span>
<span class="go">DEBUG: Asking scheduler for work...</span>
</pre></div>
</div>
<p>The best way to run is in <strong>Script Mode:</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;.&quot;</span> luigi --module mars_gym.simulation.interaction InteractionTraining <span class="se">\</span>
--project samples.trivago_simple.config.trivago_rio <span class="se">\</span>
--recommender-module-class samples.trivago_simple.simulation.SimpleLinearModel <span class="se">\</span>
--recommender-extra-params <span class="s1">&#39;{&quot;n_factors&quot;: 10, &quot;metadata_size&quot;: 148, &quot;window_hist_size&quot;: 5}&#39;</span> <span class="se">\</span>
--bandit-policy-class samples.trivago_simple.simulation.EGreedyPolicy <span class="se">\</span>
--bandit-policy-params <span class="s1">&#39;{&quot;epsilon&quot;: 0.1}&#39;</span> <span class="se">\</span>
--obs-batch-size <span class="m">100</span>

<span class="go">...</span>
<span class="go">...</span>
<span class="go">Interaction Stats (75.36%)</span>
<span class="go">          count      mean       std</span>
<span class="go">dataset</span>
<span class="go">all      7300.0  0.044110  0.205353</span>
<span class="go">train    5840.0  0.042808  0.202442</span>
<span class="go">valid    1460.0  0.049315  0.216599</span>

<span class="go">Saving logs...</span>
<span class="go">Saving test set predictions...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 4063441.72it/s]</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 3831989.55it/s]</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:16&lt;00:00, 151.33it/s]</span>

<span class="go">INFO: Informed scheduler that task   InteractionTraining____samples_trivago____epsilon___0_1__4fc1370d9d   has status   DONE</span>
<span class="go">2020-06-22 08:41:37,842 : INFO : Informed scheduler that task   InteractionTraining____samples_trivago____epsilon___0_1__4fc1370d9d   has status   DONE</span>
<span class="go">DEBUG: Asking scheduler for work...</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<ul class="simple">
<li><p>TASK_DIR/params.json</p></li>
<li><p>TASK_DIR/sim-datalog.csv</p></li>
<li><p>TASK_DIR/index_mapping.pkl</p></li>
<li><p>TASK_DIR/bandit.pkl</p></li>
<li><p>TASK_DIR/weights.pt</p></li>
<li><p>TASK_DIR/test_set_predictions.csv</p></li>
</ul>
</div>
<div class="section" id="supervised-learning">
<h2>Supervised Learning<a class="headerlink" href="#supervised-learning" title="Permalink to this headline">¶</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;.&quot;</span> luigi --module mars_gym.simulation.training TorchModelWithAgentTraining <span class="se">\</span>
--project samples.trivago_simple.config.trivago_rio<span class="se">\</span>
--recommender-module-class samples.trivago_simple.simulation.SimpleLinearModel<span class="se">\</span>
--recommender-extra-params <span class="s1">&#39;{&quot;n_factors&quot;: 10, &quot;metadata_size&quot;: 148, &quot;window_hist_size&quot;: 5}&#39;</span><span class="se">\</span>
--early-stopping-min-delta <span class="m">0</span>.0001 --negative-proportion <span class="m">0</span>.8<span class="se">\</span>
--learning-rate <span class="m">0</span>.0001 --epochs <span class="m">50</span> --batch-size <span class="m">100</span>


<span class="go">...</span>
<span class="go">...</span>
<span class="go">DEBUG: Checking if TorchModelWithAgentTraining(project=samples.trivago_simple.config.trivago_rio, sample_size=-1, minimum_interactions=5, session_test_size=0.1, test_size=0.2, dataset_split_method=time, test_split_type=random, val_size=0.2, n_splits=5, split_index=0, data_frames_preparation_extra_params={}, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, observation=, negative_proportion=0.8, recommender_module_class=samples.trivago_simple.simulation.SimpleLinearModel, recommender_extra_params={&quot;n_factors&quot;: 10, &quot;metadata_size&quot;: 148, &quot;window_hist_size&quot;: 5}, device=cuda, batch_size=100, epochs=50, optimizer=adam, optimizer_params={}, learning_rate=0.0001, loss_function=mse, loss_function_params={}, gradient_norm_clipping=0.0, gradient_norm_clipping_type=2, early_stopping_patience=5, early_stopping_min_delta=0.0001, monitor_metric=val_loss, monitor_mode=min, generator_workers=0, pin_memory=False, policy_estimator_extra_params={}, metrics=[&quot;loss&quot;], bandit_policy_class=mars_gym.model.bandit.ModelPolicy, bandit_policy_params={}) is complete</span>
<span class="go">...</span>
<span class="go">20/50(t): 100%|████████████████████████████████████████████████████████████████| 388/388 [00:01&lt;00:00, 242.70it/s, loss=0.129, running_loss=0.1277]</span>
<span class="go">20/50(v): 100%|███████████████████████████████████████████████████████████████████████████████████| 97/97 [00:00&lt;00:00, 323.86it/s, val_loss=0.125]</span>
<span class="go">21/50(t): 100%|████████████████████████████████████████████████████████████████| 388/388 [00:01&lt;00:00, 201.85it/s, loss=0.1291, running_loss=0.129]</span>
<span class="go">21/50(v): 100%|██████████████████████████████████████████████████████████████████████████████████| 97/97 [00:00&lt;00:00, 323.73it/s, val_loss=0.1252]</span>
<span class="go">Saving test set predictions...</span>
<span class="go">100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 3655489.13it/s]</span>
<span class="go">100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 3219842.88it/s]</span>
<span class="go">100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:13&lt;00:00, 181.27it/s]</span>
<span class="go">...</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/history.jpg"><img alt="_images/history.jpg" src="_images/history.jpg" style="width: 700px;" /></a>
</div>
<div class="section" id="evaluation">
<h2>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this headline">¶</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;.&quot;</span> luigi --module mars_gym.evaluation.task EvaluateTestSetPredictions <span class="se">\</span>
--model-task-id InteractionTraining____samples_trivago____epsilon___0_1__4fc1370d9d <span class="se">\</span>
--model-task-class mars_gym.simulation.interaction.InteractionTraining

<span class="go">DEBUG: Checking if EvaluateTestSetPredictions(model_task_class=mars_gym.simulation.interaction.InteractionTraining, model_task_id=InteractionTraining____samples_trivago____epsilon___1__50e3124699, offpolicy_eval=False, task_hash=none, direct_estimator_class=None, direct_estimator_negative_proportion=0.8, direct_estimator_batch_size=500, direct_estimator_epochs=50, eval_cips_cap=15, policy_estimator_extra_params={}, num_processes=12, fairness_columns=[]) is complete</span>
<span class="go">2020-06-22 09:36:41,042 : DEBUG : Pending tasks: 1</span>
<span class="go">INFO: [pid 15069] Worker Worker(salt=021781557, workers=1, host=marlesson-pc, username=marlesson, pid=15069) running   EvaluateTestSetPredictions(model_task_class=mars_gym.simulation.interaction.InteractionTraining, model_task_id=InteractionTraining____samples_trivago____epsilon___1__50e3124699, offpolicy_eval=False, task_hash=none, direct_estimator_class=None, direct_estimator_negative_proportion=0.8, direct_estimator_batch_size=500, direct_estimator_epochs=50, eval_cips_cap=15, policy_estimator_extra_params={}, num_processes=12, fairness_columns=[])</span>
<span class="go">2020-06-22 09:36:41,043 : INFO : [pid 15069] Worker Worker(salt=021781557, workers=1, host=marlesson-pc, username=marlesson, pid=15069) running   EvaluateTestSetPredictions(model_task_class=mars_gym.simulation.interaction.InteractionTraining, model_task_id=InteractionTraining____samples_trivago____epsilon___1__50e3124699, offpolicy_eval=False, task_hash=none, direct_estimator_class=None, direct_estimator_negative_proportion=0.8, direct_estimator_batch_size=500, direct_estimator_epochs=50, eval_cips_cap=15, policy_estimator_extra_params={}, num_processes=12, fairness_columns=[])</span>
<span class="go">Creating the relevance lists...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2422/2422 [00:00&lt;00:00, 4252241.23it/s]</span>
<span class="go">100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 818/818 [00:00&lt;00:00, 2999074.01it/s]</span>
<span class="go">Rank Metrics...</span>
<span class="go">Calculating average precision...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5271/5271 [00:00&lt;00:00, 4507273.47it/s]</span>
<span class="go">Calculating precision at 1...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5271/5271 [00:00&lt;00:00, 4080505.05it/s]</span>
<span class="go">Calculating nDCG at 5...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5271/5271 [00:00&lt;00:00, 4734084.88it/s]</span>
<span class="go">Calculating nDCG at 15...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5271/5271 [00:00&lt;00:00, 4644574.87it/s]</span>
<span class="go">Calculating nDCG at 20...</span>
<span class="go">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5271/5271 [00:00&lt;00:00, 4636781.96it/s]</span>
<span class="go">Fairness Metrics</span>
<span class="go">Offpolice Metrics</span>
<span class="go">2020-06-22 09:36:43,525 : INFO : Informed scheduler that task   EvaluateTestSetPredictions_500_None_50_61a88a638d   has status   DONE</span>
</pre></div>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<ul class="simple">
<li><p>EVALUATION_DIR/metrics.json</p></li>
<li><p>EVALUATION_DIR/rank_metrics.csv</p></li>
<li><p>EVALUATION_DIR/df_offpolicy.csv</p></li>
<li><p>EVALUATION_DIR/fairness_df.csv</p></li>
<li><p>EVALUATION_DIR/fairness_metrics.csv</p></li>
</ul>
<p><strong>Evaluation Platform</strong></p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> streamlit run tools/eval_viz/app.py

<span class="go">You can now view your Streamlit app in your browser.</span>
<span class="go">Local URL: http://localhost:8501</span>
<span class="go">Network URL: http://10.0.0.103:8501</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/image2.png"><img alt="_images/image2.png" src="_images/image2.png" style="width: 700px;" /></a>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum augue diam, placerat ut urna tincidunt, tristique eleifend felis. Duis tellus libero, commodo vitae mauris eu, suscipit mollis leo. Quisque in nulla fermentum, iaculis risus eu, sollicitudin est. Mauris quis elementum metus. Maecenas mattis efficitur diam at tempor. Integer consequat gravida sagittis. Nam a ultrices odio.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dataviz.html" class="btn btn-neutral float-right" title="Evaluation Plaftform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Install" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Marlesson Santana

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>